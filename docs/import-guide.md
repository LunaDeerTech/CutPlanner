# 切割清单导入功能使用说明

## 功能概述

本功能允许用户通过上传Excel文件的方式批量导入切割项目，支持以下格式：

- `.xlsx` 文件（推荐）
- `.xls` 文件

## 支持的Excel列格式

Excel文件应包含以下列标题（不区分大小写，支持中英文）：

### 必需列
- **长度**：`长度`、`length`、`长`
- **宽度**：`宽度`、`width`、`宽`  
- **数量**：`数量`、`quantity`、`个数`、`件数`

### 可选列
- **名称**：`名称`、`name`、`品名`、`描述`
- **材质**：`材质`、`material`、`材料`
- **厚度**：`厚度`、`thickness`

## Excel文件格式示例

| 名称     | 长度 | 宽度 | 数量 | 材质   |
|---------|-----|-----|-----|--------|
| 桌面板   | 1200| 600 | 1   | 橡木    |
| 抽屉面板 | 400 | 300 | 3   | 橡木    |
| 侧板     | 550 | 400 | 2   | 橡木    |
| 背板     | 1150| 500 | 1   | 三合板  |
| 隔板     | 550 | 350 | 2   | 橡木    |

## 使用步骤

1. **准备Excel文件**：按照上述格式准备包含切割项目数据的Excel文件

2. **打开导入功能**：在切割清单区域点击"上传模板"按钮

3. **上传文件**：
   - 点击上传区域选择文件，或
   - 直接拖拽Excel文件到上传区域

4. **预览数据**：系统会自动解析文件并显示数据预览表格

5. **处理警告**：如有数据格式问题，系统会显示警告信息

6. **确认导入**：检查预览数据无误后，点击"确认导入"按钮

## 数据验证规则

- **文件大小限制**：最大10MB
- **数值验证**：长度、宽度、数量必须为正数
- **数量处理**：数量会自动向下取整为整数
- **必需字段**：长度、宽度、数量不能为空
- **字符清理**：数值字段会自动清除非数字字符

## 错误处理

### 常见错误及解决方法

1. **"未找到有效的标题行"**
   - 检查Excel文件是否包含正确的列标题
   - 确保标题行在文件的前10行内

2. **"缺少必要的列"**
   - 确保Excel文件包含长度、宽度、数量列
   - 检查列标题拼写是否正确

3. **"数值必须大于0"**
   - 检查长度、宽度、数量的数值是否为正数
   - 清除数值字段中的无效字符

4. **"文件格式无效"**
   - 确保文件是.xlsx或.xls格式
   - 重新保存Excel文件

## 测试文件

项目包含一个测试Excel文件：`public/test-template.xlsx`

您可以下载此文件作为参考模板，或直接用于测试导入功能。

## 技术实现

- 使用SheetJS (xlsx)库进行Excel文件解析
- 支持多种列标题变体的智能识别
- 完整的数据验证和错误处理机制
- 用户友好的拖拽上传界面
- 实时数据预览功能

## 注意事项

- 导入的数据会追加到现有的切割清单中，不会替换已有数据
- 建议在导入前备份重要的切割项目数据
- 如需批量替换数据，请先清空现有清单再进行导入